# Story 8.7: FAQ Page Generation

## User Story

**As a** resident looking for answers
**I want** a traditional FAQ page with expandable questions
**So that** I can quickly scan and find relevant information

## Description

Create a `/faq` page that presents topics in an accordion-style FAQ format. Group questions by category with expandable answers that include links to source documents.

## Acceptance Criteria

- [ ] Page accessible at `/faq`
- [ ] Questions grouped by category (Financial, Insurance, Rules, Governance)
- [ ] Accordion-style expandable answers
- [ ] Each answer shows quick answer + link to full document
- [ ] Categories can be expanded/collapsed
- [ ] Search functionality to filter questions
- [ ] Mobile-friendly accordion behavior
- [ ] Structured data (FAQ schema) for SEO

## Technical Details

### File Location
`src/app/faq/page.tsx`

### Implementation

```tsx
import { Suspense } from 'react';
import { HelpCircle, FileText, ExternalLink } from 'lucide-react';
import {
  Accordion,
  AccordionContent,
  AccordionItem,
  AccordionTrigger,
} from '@/components/ui/accordion';
import { Badge } from '@/components/ui/badge';
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';
import Link from 'next/link';
import {
  TOPIC_INDEX,
  getTopicsByCategory,
  getAllCategories,
  type TopicCategory,
} from '@/lib/data/topic-index';

const CATEGORY_INFO: Record<TopicCategory, { title: string; description: string }> = {
  financial: {
    title: 'Financial & Assessments',
    description: 'Questions about dues, fees, payment plans, and collections',
  },
  insurance: {
    title: 'Insurance Coverage',
    description: 'Questions about HOA and owner insurance responsibilities',
  },
  rules: {
    title: 'Rules & Regulations',
    description: 'Questions about pets, parking, noise, and community rules',
  },
  governance: {
    title: 'Governance & Meetings',
    description: 'Questions about voting, records, board, and violations',
  },
};

interface FAQPageProps {
  searchParams: { q?: string };
}

export default function FAQPage({ searchParams }: FAQPageProps) {
  const { q } = searchParams;
  const categories = getAllCategories();

  // Filter topics if search query
  const filteredTopics = q
    ? TOPIC_INDEX.filter(
        (t) =>
          t.question.toLowerCase().includes(q.toLowerCase()) ||
          t.quickAnswer.toLowerCase().includes(q.toLowerCase()) ||
          t.keywords.some((kw) => kw.includes(q.toLowerCase()))
      )
    : TOPIC_INDEX;

  // Group by category
  const topicsByCategory = categories.reduce(
    (acc, cat) => {
      acc[cat] = filteredTopics.filter((t) => t.category === cat);
      return acc;
    },
    {} as Record<TopicCategory, typeof TOPIC_INDEX>
  );

  return (
    <div className="container mx-auto px-4 py-8 max-w-4xl">
      {/* Header */}
      <div className="text-center mb-8">
        <div className="w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4">
          <HelpCircle className="h-8 w-8 text-primary" />
        </div>
        <h1 className="text-3xl font-bold mb-2">Frequently Asked Questions</h1>
        <p className="text-muted-foreground">
          Find answers to common questions about Westlake Village HOA
        </p>
      </div>

      {/* Search */}
      <form className="mb-8 max-w-md mx-auto">
        <Input
          name="q"
          placeholder="Search FAQs..."
          defaultValue={q}
          className="text-center"
        />
      </form>

      {/* Results indicator */}
      {q && (
        <p className="text-sm text-muted-foreground text-center mb-6">
          {filteredTopics.length} results for &quot;{q}&quot;
          <a href="/faq" className="ml-2 text-primary hover:underline">
            Clear
          </a>
        </p>
      )}

      {/* FAQ Categories */}
      <div className="space-y-8">
        {categories.map((category) => {
          const topics = topicsByCategory[category];
          if (topics.length === 0) return null;

          return (
            <section key={category}>
              <div className="mb-4">
                <h2 className="text-xl font-semibold">
                  {CATEGORY_INFO[category].title}
                </h2>
                <p className="text-sm text-muted-foreground">
                  {CATEGORY_INFO[category].description}
                </p>
              </div>

              <Accordion type="multiple" className="space-y-2">
                {topics.map((topic) => (
                  <AccordionItem
                    key={topic.slug}
                    value={topic.slug}
                    className="border rounded-lg px-4"
                  >
                    <AccordionTrigger className="hover:no-underline">
                      <span className="text-left font-medium">
                        {topic.question}
                      </span>
                    </AccordionTrigger>
                    <AccordionContent>
                      <div className="pb-4">
                        <p className="text-muted-foreground mb-4">
                          {topic.quickAnswer}
                        </p>

                        <div className="flex flex-wrap items-center gap-2">
                          <Button asChild variant="outline" size="sm">
                            <Link href={`/documents/${topic.primaryDocument}`}>
                              <FileText className="h-4 w-4 mr-2" />
                              View Full Document
                            </Link>
                          </Button>

                          {topic.sections.length > 0 && (
                            <span className="text-xs text-muted-foreground">
                              Section: {topic.sections.join(', ')}
                            </span>
                          )}
                        </div>

                        {topic.relatedDocuments.length > 0 && (
                          <div className="mt-3 text-xs text-muted-foreground">
                            <span className="font-medium">See also: </span>
                            {topic.relatedDocuments.map((slug, i) => (
                              <span key={slug}>
                                <Link
                                  href={`/documents/${slug}`}
                                  className="text-primary hover:underline"
                                >
                                  {slug.replace(/-/g, ' ')}
                                </Link>
                                {i < topic.relatedDocuments.length - 1 && ', '}
                              </span>
                            ))}
                          </div>
                        )}
                      </div>
                    </AccordionContent>
                  </AccordionItem>
                ))}
              </Accordion>
            </section>
          );
        })}
      </div>

      {/* No results */}
      {filteredTopics.length === 0 && (
        <div className="text-center py-12">
          <HelpCircle className="h-12 w-12 text-muted-foreground mx-auto mb-4" />
          <h2 className="text-lg font-medium mb-2">No FAQs found</h2>
          <p className="text-muted-foreground mb-4">
            Try a different search term
          </p>
          <a href="/faq" className="text-primary hover:underline">
            View all FAQs
          </a>
        </div>
      )}

      {/* Still have questions */}
      <div className="mt-12 p-6 bg-muted/50 rounded-lg text-center">
        <h2 className="font-semibold mb-2">Still have questions?</h2>
        <p className="text-muted-foreground mb-4">
          Our AI assistant can help answer specific questions about HOA documents
        </p>
        <Button asChild>
          <Link href="/ask">Ask AI Assistant</Link>
        </Button>
      </div>
    </div>
  );
}

// SEO: FAQ Schema for rich results
export function generateMetadata() {
  const faqSchema = {
    '@context': 'https://schema.org',
    '@type': 'FAQPage',
    mainEntity: TOPIC_INDEX.map((topic) => ({
      '@type': 'Question',
      name: topic.question,
      acceptedAnswer: {
        '@type': 'Answer',
        text: topic.quickAnswer,
      },
    })),
  };

  return {
    title: 'FAQ | Westlake HOA Hub',
    description:
      'Frequently asked questions about Westlake Village HOA fees, insurance, rules, and governance.',
    other: {
      'script:ld+json': JSON.stringify(faqSchema),
    },
  };
}
```

### Navigation Update

Add to `src/lib/constants.ts`:

```typescript
export const NAV_ITEMS = [
  // ...
  { href: "/faq", label: "FAQ", icon: "HelpCircle" },
  // ...
];
```

## Visual Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           â“ Frequently Asked Questions              â”‚
â”‚     Find answers to common questions about           â”‚
â”‚              Westlake Village HOA                    â”‚
â”‚                                                      â”‚
â”‚  [Search FAQs...                        ]            â”‚
â”‚                                                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                      â”‚
â”‚  Financial & Assessments                             â”‚
â”‚  Questions about dues, fees, payment plans...        â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â–¸ When are HOA assessments due?                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â–¾ What are the late fees for missed payments?  â”‚  â”‚
â”‚  â”‚                                                â”‚  â”‚
â”‚  â”‚   Late fees escalate: $50 (1 month past due),  â”‚  â”‚
â”‚  â”‚   $150 (2 months), $250 (3+ months)...         â”‚  â”‚
â”‚  â”‚                                                â”‚  â”‚
â”‚  â”‚   [ğŸ“„ View Full Document]                      â”‚  â”‚
â”‚  â”‚   Section: Late Fee Schedule                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â–¸ Can I set up a payment plan?                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                      â”‚
â”‚  Insurance Coverage                                  â”‚
â”‚  Questions about HOA and owner insurance...          â”‚
â”‚  ...                                                 â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Still have questions?                          â”‚  â”‚
â”‚  â”‚ [Ask AI Assistant]                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Story Points: 5

## Priority: High

## Dependencies
- Story 8.4 (Topic Index)

## Definition of Done
- [ ] Page renders at `/faq`
- [ ] Questions grouped by category
- [ ] Accordion expand/collapse works
- [ ] Search filters questions
- [ ] Document links work
- [ ] FAQ schema in page metadata
- [ ] Navigation link added
- [ ] Mobile accordion behavior correct
- [ ] Empty state shows correctly
