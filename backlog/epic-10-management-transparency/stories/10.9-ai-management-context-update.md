# Story 10.9: AI Management Context Update

## User Story

**As a** homeowner asking the AI assistant about management
**I want** accurate answers about Bold's authority and limitations
**So that** I get reliable guidance on what management can and cannot do

## Description

Update the AI assistant's context to include detailed information about Bold Property Management's delegated authority, limitations, specific contact information, and the accountability framework. The AI should be able to answer questions like "Can Bold initiate legal action?" or "Who do I contact for maintenance?"

## Acceptance Criteria

- [ ] AI can answer questions about Bold's delegated powers
- [ ] AI can answer questions about Bold's limitations
- [ ] AI provides correct email addresses for different purposes
- [ ] AI explains escalation path when management can't help
- [ ] AI references source (governance documents, documented patterns)
- [ ] Context added to AI system prompt or knowledge base
- [ ] Tested with common management-related questions

## Technical Details

### Context Updates

Update `src/lib/ai/context-builder.ts` to include management authority context when relevant queries are detected.

### Keywords to Detect

```typescript
const MANAGEMENT_KEYWORDS = [
  "bold", "management", "property management",
  "can bold", "cannot bold", "bold able to",
  "management authority", "who can", "who approves",
  "escalate", "escalation", "legal action",
  "collections", "foreclosure", "authorize",
  "contact management", "email bold", "reach management"
];
```

### Context Content to Add

```typescript
const MANAGEMENT_CONTEXT = `
## Property Management Authority - Bold Property Management / Bold Solutions

### Delegated Powers (What Bold CAN Do)
Bold is authorized to:
- Act as the HOA's managing agent
- Receive and respond to owner communications
- Maintain official HOA records
- Coordinate records inspections
- Send delinquency notices (First Contact / Notice of Delinquency)
- Sign Notices of Assessment Lien (delegated authority)
- Maintain contact and communication logs
- Coordinate vendor services
- Schedule and oversee maintenance

### Authority Limitations (What Bold CANNOT Do)
Bold cannot independently:
- Initiate legal action (requires Board authorization)
- Refer accounts to attorneys without a recorded Board vote
- Approve foreclosures (requires explicit Board authorization)

### Contact Information
- General/Client Services: clientservices@boldsolutions.net
- Mass Communications: communications@boldpropertymanagement.mailer.appfolio.us (automated notices)
- Mailing: PO Box 5800, Avon, CO 81620

### Escalation Path
1. Bold Property Management (initial contact)
2. Board of Directors (when Bold cannot act)
3. Alpenglow Law, LLC (legal escalation, by Board referral)
4. Independent counsel/regulatory (external resolution)

### Accountability
Bold is not a passive administrator. Under governing documents and Colorado law,
it functions as an operational extension of the HOA. Delays, non-responses, or
failures to act fall within this delegated role.

### Observed Patterns
- Bulk notices via AppFolio email
- Limited responsiveness to individual follow-ups
- Escalation to legal counsel for disputes
- Formal written requests often required for records
`;
```

### System Prompt Update

Add to the AI system prompt in `src/app/api/chat/route.ts`:

```typescript
const systemPrompt = `
... existing prompt ...

When answering questions about property management:
1. Clearly distinguish what Bold CAN vs CANNOT do
2. Provide specific contact information when relevant
3. Explain when Board authorization is required
4. Reference the escalation path for unresolved issues
5. Note that delays or non-response fall within Bold's delegated role

${MANAGEMENT_CONTEXT}
`;
```

### Test Queries

The AI should correctly answer:

| Query | Expected Answer Includes |
|-------|-------------------------|
| "Can Bold initiate legal action?" | No, requires Board authorization |
| "Who do I contact for maintenance?" | clientservices@boldsolutions.net |
| "Can management waive my late fee?" | Bold cannot independently, needs Board |
| "How do I escalate an issue?" | Bold → Board → Legal Counsel |
| "What records does Bold maintain?" | Financial, owner ledgers, contracts, etc. |
| "Can Bold approve foreclosure?" | No, requires Board authorization |
| "Why isn't management responding?" | Note about limited responsiveness pattern |

### Integration Points

1. **Context Builder** - Add management context when keywords detected
2. **Keyword Detection** - Expand keyword list for management queries
3. **System Prompt** - Include accountability framework

## Story Points: 3

## Priority: High

## Dependencies

- Story 10.1 (Management Page) - for data consistency
- Story 10.2 (Delegated Authority) - for authority list
- Story 10.3 (Authority Limitations) - for limitations list
- Story 10.10 (Data Model) - for data structures

## Definition of Done

- [ ] Management context added to AI knowledge base
- [ ] Keywords for management queries defined
- [ ] Context builder updated to include management info
- [ ] Test query "Can Bold initiate legal action?" answered correctly
- [ ] Test query about contact info answered correctly
- [ ] Escalation path explained when relevant
- [ ] Accountability note included in relevant answers
- [ ] No degradation of other AI responses
- [ ] Citations reference correct sources
