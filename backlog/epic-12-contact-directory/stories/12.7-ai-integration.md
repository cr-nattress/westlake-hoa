# Story 12.7: Integrate with AI Assistant

## User Story

**As a** homeowner using the AI assistant
**I want** the AI to provide accurate, complete contact information
**So that** I get the right contact details when I ask

## Description

Ensure the AI assistant has access to the complete contact directory data and can provide accurate responses to contact-related questions. Update the context builder to include the full contact data.

## Acceptance Criteria

- [ ] AI can answer "who do I contact for X" questions
- [ ] AI provides specific phone numbers when asked
- [ ] AI provides specific email addresses when asked
- [ ] AI knows key personnel names and roles
- [ ] AI directs users to the /contacts page for full directory
- [ ] AI distinguishes between contact types correctly

## Example Queries the AI Should Handle

1. "What's the phone number for insurance claims?"
   → "(800) 390-0559 or (970) 945-9111 for Mountain West Insurance"

2. "Who do I email about a maintenance issue?"
   → "clientservices@boldsolutions.net for Bold Property Management"

3. "What's the HOA board email?"
   → "WLVAVON@gmail.com"

4. "How do I contact the insurance agent?"
   → Meghan Wilson details with phone and email

5. "Who is the HOA attorney?"
   → T.J. Voboril information

## Technical Details

### Update Context Builder

```typescript
// src/lib/ai/context-builder.ts

// Add contact data to relevant queries
const CONTACT_KEYWORDS = [
  "contact", "phone", "email", "call", "reach",
  "who", "address", "fax", "number"
];

function shouldIncludeContacts(query: string): boolean {
  const lowerQuery = query.toLowerCase();
  return CONTACT_KEYWORDS.some(kw => lowerQuery.includes(kw));
}

// In buildAIContext function
if (shouldIncludeContacts(query)) {
  context.documents.push({
    title: "Contact Directory",
    content: formatContactsForAI(ALL_CONTACTS),
    source: "/contacts",
  });
}
```

### Format Contacts for AI

```typescript
function formatContactsForAI(contacts: ContactEntityFull[]): string {
  return contacts.map(c => `
## ${c.name}
Role: ${c.role}
${c.phones ? `Phone Numbers:\n${c.phones.map(p => `- ${p.number} (${p.purpose})`).join('\n')}` : ''}
${c.emails ? `Email Addresses:\n${c.emails.map(e => `- ${e.address} (${e.purpose})`).join('\n')}` : ''}
${c.keyContacts ? `Key Contacts:\n${c.keyContacts.map(kc => `- ${kc.name}: ${kc.title}`).join('\n')}` : ''}
${c.notes ? `Notes:\n${c.notes.map(n => `- ${n}`).join('\n')}` : ''}
`).join('\n---\n');
}
```

### Add to Document Facts

```typescript
// src/lib/data/document-facts.ts
// Add facts about contact information

{
  topic: "insurance-contact",
  fact: "Mountain West Insurance main phone: (800) 390-0559 or (970) 945-9111",
  source: "Contact Directory",
},
{
  topic: "management-contact",
  fact: "Bold Property Management email: clientservices@boldsolutions.net",
  source: "Contact Directory",
},
// etc.
```

## Story Points: 2

## Priority: Low

## Dependencies

- Story 12.3 (Updated Institutional Knowledge)

## Definition of Done

- [ ] AI responds correctly to contact queries
- [ ] All phone numbers accessible to AI
- [ ] All email addresses accessible to AI
- [ ] Key personnel information available
- [ ] AI suggests /contacts page for full info
- [ ] No incorrect contact information provided
